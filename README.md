# AerospikeTree
Aerospike技术研究


<pre>
Aerospike的优势

    Aerospike是一个高性能、可扩展、可靠性强的NoSQL解决方案，支持RAM和SSD作为存储介质，并
    专门针对SSD特殊优化，广泛应用于实时竞价等实时计算领域。官方保证99%的操作在1ms内完成，
    并提供集群数据自动Rebalance、集群感知客户端等功能，且支持超大规模数据集(100T级别)的存储。

    作为KV存储，Aerospike提供多种数据类型，其操作方式和Redis比较类似。除基础功能之
    外，Aerospike还支持AMC控制台、API等多种监控方式，有集群QPS、健康度、负载等多项监控
    指标，对运维比较友好。支持集群内数据的自动Rebalance，和Redis集群方案相比，维护成本下降不少

    redis数据完全存储在内存虽然保证了查询性能，但是成本太高，aerospike最大的卖点就是数据可以存储在SSD上，并且保证了和redis相同的查询性能，内部在访问SSD时屏蔽了文件系统层级，直接访问地址，保证了数据的读取速度

    policies决定namespace的行为，包括
		1）数据的存储位置： 内存还是SSD盘
		2）一条记录存储的副本个数
		3）过期时间TTL, aerospike可以在库的层级进行全局设置，并且支持对于已经存在的数据进行TTL的设置
    Aerospike最主要的优势是采用混合存储结构，数据索引信息存储在RAM中，而数据本身可以存储在SSD盘，通过直接硬盘访问可以带来难以置信的性能,主要应用于数百G,数T等大规模并且并发数在数万以上，对读写性能要求较高的场景，目前主要集中在互联网广告领域。
    Aerospike的架构针对以下三个主要目标
		1）创建一个满足当今网络平台应用的可弹性扩展平台
		2）提供与传统数据库一样的鲁棒性和可靠性(ACID)
		3）以最小的人工参与，提高运维效率，降低运维成本
</pre>

![](https://i.imgur.com/TDzl7Ur.png)


![](https://i.imgur.com/3S8Hg6s.png)

<pre>
1. 数据存放

   数据可以放内存，也可以放SSD。
   数据放内存时速度肯定会很快，但这和memcache一样，相比memcache性能并没有优势

   数据放内存时可以进行持久化配置，但文档只有一个地方提了一下，没展开描述，说明持久化不
   推荐使用。

   数据也可以放SSD，并做了特定优化，相比mysql会更快，但数据操作模型过于简单，可使用场景
   很少。也比mongo性能更好，但其要求SSD存储，这样容量较小，费用也较高，这时mongo是好选择

2. 数据操作模型
    
  支持 按主键及二级索引筛选数据
  支持 聚合 （强大，一个卖点）
  不支持排序（通过聚合功能的lua脚本也可能可以实现，但并不现实）
  
  虽然支持类SQL语法操作，但可进行的操作非常简单，好于memcache, 稍好于mongo，比redis
  差些，跟mysql完全没法比，但其聚合功能还比较强大。

3. 集群管理

   相当强大，多个平等的结点，平摊存储所有数据，并且互相备份。集群结点的失效及添加完全自动
   化处理，不影响用户请求。
   
   相比memcache，这是它强大的地方，也不会弱于其它nosql的集群管理

5. 聚合功能

   这里聚合的概念等同于mysql中的聚合。可以通过编写lua脚本，实现对数据的聚合，此时
   aerospike可以看作一个分布式的基于内存的map-reduce计算平台，相比普通
   的hadoop map-reduce,速度是很快的,当然，可处理的数据量相对较少
</pre>

<pre>
aerospike可能应用场景 

aerospike总体来说是一个基于内存的并且具有高度可靠性的分布式计算系统。放在内存中是易失的，
更多场景应该是放在SSD，但放在SSD其性能就不一定具有太大优势了，而且SSD存储容量小，费用也是
比较贵的。

1. 替换memcache做缓存

    这是由于它有强大的集群管理功能，对非常重要不能宕机的缓存服务可以采用它，但代价就是需要
    更多的硬件服务器。

2.性能要求很高的实时聚合计算
    aerospike是一个分布式的基于内存的map-reduce服务，速度快。
    一般来说，原始数据变化较频繁，而对聚合计算实时要求较高的情景可以用它
</pre>


